---
title: "[AI Tech] WandBλ¥Ό ν™μ©ν•΄μ„ ν•μ΄νΌ νλΌλ―Έν„° μµμ ν™”λ¥Ό ν•΄λ³΄μ"
excerpt: "ν”„λ΅μ νΈμ— WandBλ¥Ό μ μ©ν•΄λ³΄μ!"

categories:
  - boostcamp
tags:
  - [boostcamp, ai, wandb]

permalink: /boostcamp/wandb2/

toc: true
toc_sticky: true

date: 2023-12-17
last_modified_at: 2023-12-18
---
# WandB ν™μ©ν•΄λ³΄κΈ° 2νƒ„
## λ¶€μ : WandBμ sweep κΈ°λ¥μ„ ν™μ©ν•΄μ„ ν•μ΄νΌ νλΌλ―Έν„° μµμ ν™”λ¥Ό ν•΄λ³΄μ!!


WandB ν™μ©ν•΄λ³΄κΈ° 1νƒ„μ— μ΄μ–΄ 2νƒ„μΌλ΅ λμ•„μ™”μµλ‹λ‹¤! π‰π‰π‰

μ§€λ‚λ²μ—λ” WandB κ³„μ •μ„ μƒμ„±ν•΄μ„ μ›κ²© λ ν¬μ™€ λ΅μ»¬ λ ν¬λ¥Ό μ—°λ™ν•΄μ„ μ‹¤ν—κ΄€λ¦¬ μ‹μ¤ν…μ„ κµ¬μ¶•ν•λ” κ²ƒκΉμ§€ μ§„ν–‰ν–λ”λ°μ”!

μ΄λ²μ—λ” WandBμ sweepκΈ°λ¥μ„ ν†µν•΄ ν•μ΄νΌ νλΌλ―Έν„° μµμ ν™”λ¥Ό μ§„ν–‰ν•΄λ³΄κ² μµλ‹λ‹¤. 

## Sweep μ„¤μ • νμΌ μ‘μ„±

sweepμ— configurationμ„ μ „λ‹¬ν•λ” λ°©λ²•μ€ 1. μ…€ μ¤ν¬λ¦½νΈμ— λ”•μ…”λ„λ¦¬ ν•νƒλ΅ μ§μ ‘ μ£Όλ” λ°©λ²•κ³Ό 2. μ‘μ„±λ yamlνμΌμ„ cliμ—μ„ μΈμλ΅ λ„κ²¨μ£Όλ” 2κ°€μ§€ λ°©λ²•μ΄ μμµλ‹λ‹¤.

μ΄λ²μ—λ” yamlνμΌμ„ λ„κ²¨μ£Όλ” λ°©λ²•μΌλ΅ μ§„ν–‰ν•κ² μµλ‹λ‹¤.

```yaml
program: main.py

method: bayes

name: ncf-sweep

metric:
  name: Valid Loss
  goal: minimize

parameters:
  model:
    values: ['NCF']

  lr:
    distribution: uniform
    min: 0.0001
    max: 0.01

  batch_size:
    values: [32, 64, 128]

  embed_dim:
    values: [8, 16, 32]

  mlp_dims:
    values:
			- 16,16
			- 32,32
      - 16,32,64
      - 32,64,128

  epochs:
    values: [10, 30, 50, 100]

  dropout:
    values : [0.1, 0.2, 0.3]
```

NCFλ¨λΈμ ν•μ΄νΌνλΌλ―Έν„°λ¥Ό yamlνμΌμ— μ‘μ„±ν–μµλ‹λ‹¤. 

`program` : μ‹¤ν–‰ν•  νμΌ κ²½λ΅λ¥Ό μ…λ ¥ν•΄μ¤λ‹λ‹¤.

`method` : ν•μ΄νΌνλΌλ―Έν„° μµμ ν™” λ°©λ²•μΌλ΅ λλ¤μ„μΉ, κ·Έλ¦¬λ“μ„μΉ, λ² μ΄μ§€μ• μµμ ν™” 3κ°€μ§€ λ°©λ²•μ΄ μ΅΄μ¬ν•©λ‹λ‹¤.

`name`: μ›κ²© λ ν¬μ— κΈ°λ΅λ  μ‹¤ν— μ΄λ¦„μ…λ‹λ‹¤.

`metric`: μµμ ν™”ν•  λ©μ ν•¨μλ΅ μ΄λ• `name`μ€ wandb.logλ΅ λ„κ²¨μ¤€ ν‚¤κ°’μ„ μ£Όμ–΄μ•Όν•λ©° `goal`μ„ ν†µν•΄ minimize, maximizeμ—¬λ¶€λ¥Ό κ²°μ •ν•΄μ¤λ‹λ‹¤.

`parameter`: ν•μ΄νΌ νλΌλ―Έν„°λ΅ μ°λ¦¬κ°€ μ •ν•΄μ¤€ `method`μ— λ”°λΌμ„ μ„ νƒλμ–΄ μ‹¤ν—μ΄ μ§„ν–‰λ©λ‹λ‹¤. μ—°μ†ν• νΉμ€ μ΄μ‚°ν•μΌλ΅ κ°’μ„ μ§€μ •ν•΄ μ¤„ μ μμΌλ©°, μ—°μ†ν•μΌλ΅ μ§€μ •ν•  μ‹ μµμ†κ°’κ³Ό μµλ€κ°’μ„ μ •ν•΄μ¤„ μ μμµλ‹λ‹¤.

## Sweepμ„ μ‹¤ν–‰ν•΄λ³΄μ!

μ΄μ  yamlνμΌμ„ μƒμ„±ν–μΌλ‹ μ‹¤ν–‰ν•΄λ³΄κ² μµλ‹λ‹¤.

```bash
wandb sweep --entity <μ΅°μ§λ…> --project <ν”„λ΅μ νΈλ…> <sweep.yamlκ²½λ΅>
```

ν„°λ―Έλ„μ— μ΅°μ§λ…, ν”„λ΅μ νΈλ…, sweep.yamlμ κ²½λ΅λ¥Ό μΈμλ΅ μ£Όκ³  μ‹¤ν–‰μ‹ν‚µλ‹λ‹¤.

![wandbμ„¤μ •](https://github.com/ChangZero/ChangZero.github.io/assets/97018869/6d284405-ed15-4717-b886-4d9ebbbf4311)

μ„±κ³µμ μΌλ΅ yamlνμ΄μ„ μ½μ–΄λ“λ¦¬λ©΄ λ‹¤μκ³Ό κ°™μ΄ agent IDλ¥Ό λ°κΈ‰ν•΄μ¤λ‹λ‹¤.

```bash
wandb agent --count <μ‹¤ν— νμ> <μ΅°μ§λ…>/<ν”„λ΅μ νΈλ…>/<ID>
```
![Untitled (27)](https://github.com/ChangZero/ChangZero.github.io/assets/97018869/8ca24476-903d-41c7-866a-284eae3f2dc5)

ν•΄λ‹Ή λ…λ Ήμ„ μ£Όλ©΄ μ„¤μ •ν•΄μ¤€ μ‹¤ν— νμλ§νΌ μµμ ν™” μ‹¤ν—μ΄ μ§„ν–‰λ©λ‹λ‹¤.

μ„ μ‚¬μ§„μ²λΌ λ¨Όκ°€ μ§„ν–‰λλ”κ±° κ°™μ€λ©΄ λ§κ² μ λ”°λΌ μ¤μ‹ κ²λ‹λ‹¤. γ…γ…

wandb ν™νμ΄μ§€μ—μ„ ν™•μΈν•΄λ³΄λ©΄ λ‹¤μκ³Ό κ°™μ΄ μ‹¤ν— κ²°κ³Όλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

![Untitled (28)](https://github.com/ChangZero/ChangZero.github.io/assets/97018869/3a7787cb-01f5-4a2f-a974-c449ebca24e7)

?? ν  κ°„λ‹¨ν•κ² λλ Έμ„λ• μ‹¤ν—κ²°κ³Όλ” μ²μ°Έν•μ§€λ§β€¦ μΌλ‹¨ λμ•„κ°€κΈ΄ν•λ” κ±Έλ£¨β€¦

μ΄μ  ν•μ΄νΌνλΌλ―Έν„° μµμ ν™” κΈ°λ¥μ„ κµ¬ν„ν–μΌλ‹ nohup λ…λ Ήμ–΄(λ°±κ·ΈλΌμ΄λ“ λ…λ Ήμ–΄)λ΅ μ‹¤ν–‰μ‹μΌμ£Όκ³  ν‡΄κ·Όν•΄μ£Όλ©΄ λ©λ‹λ‹¤.γ…γ…

```bash
nohup wandb agent --count 10000 <μ΅°μ§λ…>/<ν”„λ΅μ νΈλ…>/<ID> > sweep.out &
```

λ‹¤μλ‚  μ¶κ·Ό ν›„ κ²°κ³Όλ¥Ό ν™•μΈν•΄μ£Όλ©΄ λ°¤λ™μ• μλ μ‹¤ν— κ²°κ³Όλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤ π¥³π¥³π¥³π¥³ 

![Untitled (29)](https://github.com/ChangZero/ChangZero.github.io/assets/97018869/7e313b0e-dad9-4b39-8aa6-feb42a4581d3)

## μ°Έκ³ λ¬Έν—

https://docs.wandb.ai/guides/sweeps